# 计算机性能的定义

吞吐率(throughput)和响应时间(response time)是考量一个计算机系统性能的两个基本指标:

- 吞吐率表示在单位时间内所完成的工作量，类似的概念是带宽(bandwidth)，它表示单位时间内所传输的信息量
- 响应时间是指从作业提交开始到作业完成所用的时间，类似的概念是执行时间(execution time)和等待时间(latency)，它们都是用来表示一个任务所用时间的度量值

# 计算机性能的测试

操作系统在对处理器进行调度时，一段时间内往往会让多个程序(更准确地说是进程)轮流使用处理器，因此在某个用户程序执行过程中，可能同时还会有其他用户程序和操作系统程序在执行，所以，通常情况下，一个程序的执行时间除了程序包含的指令在CPU上执行所用的时间外，还包括磁盘访问时间、输入输出操作所需时间以及操作系统运行这个程序所用的额外开销等，也即，用户感觉到的某个程序的执行时间并不是其真正的执行时间。通常把用户感觉到的执行时间分成以下两部分CPU 时间和其他时间:

- CPU 时间: CPU 时间指 CPU 用于本程序执行的时间，它又包括以下两部分：
    - 用户 CPU 时间，指真正用于运行用户程序代码的时间
    - 系统CPU时间，指为了执行用户程序而需要CPU运行操作系统程序的时间
- 其他时间: 指等待 I/O 操作完成的时间或 CPU 用于执行其他用户程序的时间

计算机系统的性能评价主要考虑的是 CPU 性能。系统性能和 CPU 性能并不等价，两者有一些区别。系统性能是指系统的响应时间，它与 CPU 外的其他部分也有关系；而 CPU 性能是指用户 CPU 时间，它只包含 CPU 运行用户程序代码的时间。

在对 CPU 时间进行计算时需要用到以下几个重要的概念和指标:

- 时钟周期：计算机执行一条指令的过程被分成若干步骤(微操作)来完成，每一步都要有相应的控制信号进行控制，这些控制信号何时发出、作用时间多长，都要有相应的定时信号进行同步。因此，计算机必须能够产生同步的时钟定时信号，也就是 CPU 的主脉冲信号，其宽度称为时钟周期
- 时钟频率：CPU 的主频就是 CPU 中的主脉冲信号的时钟频率(clock rate)，是 CPU 时钟周期的倒数
- CPI：CPI(Cycles Per Instruction)表示执行一条指令所需的时钟周期数。由于不同指令的功能不同，所需的时钟周期数也不同:
    - 对于一条特定指令而言，其 CPI 指执行该条指令所需的时钟周期数，此时CPI是一个确定的值
    - 对于一个程序或一台机器来说，其 CPI 指该程序或该机器指令集中的所有指令执行所需的平均时钟周期数，此时，CPI 是一个平均值

已知上述参数或指标，可以通过以下公式来计算用户程序的CPU执行时间，即用户CPU时间:

```
用户CPU时间 = 程序总时钟周期数 / 时钟频率 = 程序总时钟周期数 × 时钟周期
```

程序总时钟周期数可由程序总指令条数和相应的 CPI 求得:
```
程序总时钟周期数 = 程序总指令条数 × CPI
```

若已知程序综合 CPI 和总指令条数，则可用下列公式计算用户 CPU 时间:
```
用户CPU时间 = CPI × 程序总指令条数 × 时钟周期
```

用户 CPU 时间度量公式中的时钟周期、指令条数、CPI 三个因素是相互制约的。例如，更改指令集可以减少程序总指令条数，但是，同时可能引起 CPU 结构的调整，从而可能会增加时钟周期的宽度(即降低时钟频率)。对于解决同一个问题的不同程序，即使是在同一台计算机上，指令条数最少的程序也不一定执行得最快。


# 使用指令执行速度进行性能评估

指令速度所用的计量单位为 MIPS(Million Instructions Per Second)，其含义是平均每秒执行多少百万条指令。

设某类指令在程序中所占比例为 w1，执行时间为 t1，则等效指令的执行时间为：$T = w1t1 + w2t2 + ... + wn*tn$，(n 为指令种类数)，若指令执行时间用时钟周期数来衡量的话，则上式计算的结果就是 CPI。对指令平均执行时间求倒数能够得到 MIPS 值。选取一组指令组合，使得得到的平均 CPI 最小，由此得到的 MIPS 就是峰值 MIPS(peak MIPS)。有些制造商经常将峰值 MIPS 直接当作 MIPS，而实际上的性能要比标称的性能差。

MIPS 反映的是机器定点运算执行的速度。浮点操作速度的指标是 MFLOPS(Million FLOating-point operations Per Second)或 Mflop/s。它表示每秒所执行的浮点运算有多少百万(10^6)次，它是基于所完成的操作次数而不是指令数来衡量的。类似的浮点操作速度还有 GFLOPS 或 Gflop/s(10^9)、TFLOPS或 Tflop/s(10^12)、PFLOPS 或 Pflop/s(10^15)和 EFLOPS 或 Eflop/s(10^18)等。


